<!DOCTYPE html>
<html lang="es" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title>UZapp</title>
    <link rel="shortcut icon" href="images/favicon.ico"/>

    <!-- compiled css output -->
    <link href="lib/leaflet/leaflet.css" rel="stylesheet">
    <link href="css/ionic.app.css" rel="stylesheet">
    <link href="scss/ionic.app.scss" rel="stylesheet">
    <link rel="stylesheet" href="images/icons/flaticon.css" />
    <link rel="stylesheet" href="lib/font-awesome-4.6.3/css/font-awesome.min.css" />

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>
    <script src="lib/ionic/js/angular/angular-resource.min.js"></script>
    <script src="lib/angular-translate.min.js"></script>
    <script src="lib/angular-route.min.js"></script>
    <script src="lib/angularSlideables.js"></script>
    <script src="lib/jquery-2.2.4.min.js"></script>

    <!-- LeafletJS library && Google Maps API-->
    <script src="lib/leaflet/leaflet.js"></script>
    <link rel="stylesheet" href="lib/leaflet/leaflet.css" />
    <script src="lib/leaflet/leaflet-plugins/master/layer/tile/Google.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyARnM8rZhDMLtxgx0AehKESZHG7-0KeS4U"></script>
    <script src="lib/leaflet/leaflet-plugins/L.TileLayer.BetterWMS.js"></script>


    <!-- Cordova script (this will be a 404 during development) -->
    <script src="lib/ng-cordova.min.js"></script>
    <script src="cordova.js"></script>

    <!-- My app's js files -->
    <script src="js/app.js"></script>
    <script src="js/constants.js"></script>
    <script src="js/directives/fancySelect.js"></script>
    <script src="js/directives/formAddPOI.js"></script>
    <script src="js/directives/formEditPOI.js"></script>
    <script src="js/services/sharedProperties.js"></script>
    <script src="js/services/geoService.test.js"></script>
    <script src="js/services/translationService.js"></script>
    <script src="js/factories/infoServiceFactory.js"></script>
    <script src="js/factories/poisServiceFactory.js"></script>
    <script src="js/factories/photosServiceFactory.js"></script>
    <script src="js/controllers/topController.js"></script>
    <script src="js/controllers/translateController.js"></script>
    <script src="js/controllers/mapController.js"></script>
    <script src="js/controllers/planController.js"></script>
    <script src="js/controllers/estanciaController.js"></script>
    <script src="js/controllers/photosController.js"></script>
    <script src="js/controllers/searchController.js"></script>
    <script src="js/controllers/appController.js"></script>

    <!-- Librerias para geolocalizar al usuario-->
    <link rel="stylesheet" href="lib/leaflet/leaflet-plugins/locate/L.Control.Locate.min.css" />
    <script src="lib/leaflet/leaflet-plugins/locate/L.Control.Locate.min.js" ></script>

    <!-- libreria para buscar marcadores http://labs.easyblog.it/maps/leaflet-search/-->
    <link rel="stylesheet" href="lib/leaflet/leaflet-plugins/search/leaflet-search.mobile.src.css" >
    <link rel="stylesheet" href="lib/leaflet/leaflet-plugins/search/leaflet-search.src.css" />
    <script src="lib/leaflet/leaflet-plugins/search/leaflet-search.src.js" ></script>
</head>

<body ng-app="UZCampusWebMapApp" ng-controller="TranslationCtrl">
    <ion-nav-view ></ion-nav-view>
</body>

<script>
/* Necesario hacerlo de esta manera ya que no se puede añadir codigo de angularJS dentro de un marcador de leaflet
*  la posible alternativa era usar el plugin angular-leaflet-directive pero requeria cambiar toda la parte de leaflet
*  y no aseguraba su correcto funcionamiento.
*/
    //Selecciono un plano de la planta seleccionada.
    function selectPlano(planta) {
        console.log("selectPlano", arguments);
        localStorage.planta = planta.value;
        var floor = JSON.stringify($('.'+planta.value).data());
        if (typeof(floor) == 'undefined') localStorage.floor = planta.floor;
        else localStorage.floor = floor;
        window.location = "#/app/plano";
    }
    //Selecciono un plano de la planta seleccionada.
    function informacionEstancia(estancia){
        localStorage.estancia = estancia.value;
        window.location = "#/app/estancia";
    }
    //Edición de un POI
    function editPOI(){
        var id = $('.button-edit-poi').data().id;
        var scope = angular.element($('#plan')).scope();
        scope.openEditPOIModal(id);
    }
</script>
</html>